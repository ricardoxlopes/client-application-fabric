{"version":3,"sources":["../src/index.js"],"names":["Store","__STYLES__","__KEYFRAMES__","__KEYS__","__STYLE_TAG__","document","createElement","head","appendChild","key","innerHTML","hash","getName","obj","prop","Object","keys","diff","push","newObj","update","addStyles","store"],"mappings":";;;;;;;;;;;;;AAAA;;AACA;;;;AACA;;;;;;;;IAEMA,K;AACJ,mBAAc;AAAA;;AACZ,SAAKC,UAAL,GAAkB,EAAlB;AACA,SAAKC,aAAL,GAAqB,EAArB;AACA,SAAKC,QAAL,GAAgB,EAAhB;AACA,SAAKC,aAAL,GAAqBC,SAASC,aAAT,CAAuB,OAAvB,CAArB;AACAD,aAASE,IAAT,CAAcC,WAAd,CAA0B,KAAKJ,aAA/B;AACD;;;;yBAEIK,G,EAAK;AACR,UAAI,oBAAQA,GAAR,EAAa,KAAKN,QAAlB,CAAJ,EAAiC;AAC/B,eAAO,KAAP;AACD;AACD,aAAO,IAAP;AACD;;;6BAEQ;AACP,WAAKC,aAAL,CAAmBM,SAAnB,GAA+B,2BAAiB,KAAKT,UAAtB,EAAkC,KAAKC,aAAvC,CAA/B;AACD;;;4BAEOS,I,EAAM;AACZ,aAAO,YAAOC,OAAP,CAAeD,IAAf,EAAqB,KAAKR,QAA1B,CAAP;AACD;;;8BAESU,G,EAAKC,I,EAAM;AAAA,yBACLC,OAAOC,IAAP,CAAYH,GAAZ,CADK;AAAA;AAAA,UACZJ,GADY;;AAEnB,UAAI,KAAKQ,IAAL,CAAUR,GAAV,CAAJ,EAAoB;AAClB,aAAKN,QAAL,CAAce,IAAd,CAAmBT,GAAnB;AACA,YAAMU,6BACH,KAAKP,OAAL,CAAaH,GAAb,CADG,EACiBI,IAAIJ,GAAJ,CADjB,CAAN;AAGA,aAAKK,IAAL,iBAAiB,KAAKA,IAAL,CAAjB,EAAgCK,MAAhC;AACA,aAAKC,MAAL;AACD;AACD;AACA;AACD;;;6BAEQP,G,EAAK;AACZ,WAAKQ,SAAL,CAAeR,GAAf,EAAoB,YAApB;AACD;;;iCAEYA,G,EAAK;AAChB,WAAKQ,SAAL,CAAeR,GAAf,EAAoB,eAApB;AACD;;;;;;AAGH,IAAMS,QAAQ,IAAItB,KAAJ,EAAd;QACQsB,K,GAAAA,K;kBACOA,K","file":"index.js","sourcesContent":["import {isFalsy} from '@stiligita/utils'\nimport createStyleBlock from '@stiligita/stylesheets'\nimport {render} from '@stiligita/dom'\n\nclass Store {\n  constructor() {\n    this.__STYLES__ = {}\n    this.__KEYFRAMES__ = {}\n    this.__KEYS__ = []\n    this.__STYLE_TAG__ = document.createElement('style')\n    document.head.appendChild(this.__STYLE_TAG__)\n  }\n\n  diff(key) {\n    if (isFalsy(key, this.__KEYS__)) {\n      return false\n    }\n    return true\n  }\n\n  update() {\n    this.__STYLE_TAG__.innerHTML = createStyleBlock(this.__STYLES__, this.__KEYFRAMES__)\n  }\n\n  getName(hash) {\n    return render.getName(hash, this.__KEYS__)\n  }\n\n  addStyles(obj, prop) {\n    const [key] = Object.keys(obj)\n    if (this.diff(key)) {\n      this.__KEYS__.push(key)\n      const newObj = {\n        [this.getName(key)]: obj[key]\n      }\n      this[prop] = {...this[prop], ...newObj}\n      this.update()\n    }\n    // Styles have already been written\n    // no need for operations\n  }\n\n  addRules(obj) {\n    this.addStyles(obj, '__STYLES__')\n  }\n\n  addKeyframes(obj) {\n    this.addStyles(obj, '__KEYFRAMES__')\n  }\n}\n\nconst store = new Store()\nexport {store}\nexport default store\n"]}